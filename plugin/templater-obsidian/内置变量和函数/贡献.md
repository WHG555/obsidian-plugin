# 贡献

您可以通过开发新的内部函数/变量来为 [[Templater]] 做出贡献。

开发新产品的过程非常简单。

请记住，只有相关的提交才会被接受，不要提交一个非常具体的内部变量/函数，你将是唯一使用的。

## 布局

内部变量/函数按模块排序。每个模块下都有一个专用文件夹 [src/InternalTemplates](https://github.com/SilentVoid13/Templater/tree/master/src/InternalTemplates)。

以 [[日期模块]] 为例。

它包含一个 [InternalModuleDate](https://github.com/SilentVoid13/Templater/blob/master/src/InternalTemplates/date/InternalModuleDate.ts) 文件，其中定义和注册了所有与内部日期相关的变量和函数：

```js
export class InternalModuleDate extends InternalModule {
    name = "date";

    async createStaticTemplates() {
        this.static_templates.set("now", this.generate_now());
        this.static_templates.set("tomorrow", this.generate_tomorrow());
        this.static_templates.set("yesterday", this.generate_yesterday());
    }

    async updateTemplates() {}

    generate_now() {
        return (format: string = "YYYY-MM-DD", offset?: number, reference?: string, reference_format?: string) => {
            if (reference && !window.moment(reference, reference_format).isValid()) {
                throw new Error("Invalid title date format, try specifying one with the argument 'reference'");
            }
            return get_date_string(format, offset, reference, reference_format);
        }
    }

    generate_tomorrow() {
        return (format: string = "YYYY-MM-DD") => {
            return get_date_string(format, 1);
        }
    }

    generate_yesterday() {
        return (format: string = "YYYY-MM-DD") => {
            return get_date_string(format, -1);
        }
    }
}

```

每一个继承抽象类 [InternalModule](https://github.com/SilentVoid13/Templater/blob/master/src/InternalTemplates/InternalModule.ts) 的模块，都意味着他们包含以下属性和方法：

- `this.app` 属性：黑曜石 API `App` 对象。
- `this.file` 属性: 将插入模板的目标文件。
- `this.plugin`属性：模板插件对象。
- ``this.static_templates` 属性：包含所有静态（名称；变量/函数）的映射。静态变量/函数意味着它在执行时不依赖于文件。每次我们插入新模板时，这些类型的变量/函数都不会更新，以节省一些开销。
- `this.dynamic_templates` 属性：与 `static_templates` 相同，除了它包含执行时依赖于文件的变量/函数。
- `this.createStaticTemplates()` 方法：为该模块注册所有静态内部变量/函数。
- `this.updateTemplates()` 方法：为该模块注册每个动态内部变量/函数。

如果需要，您可以在新的内部变量/函数中使用这些属性。

## 注册一个新的内部变量/函数

以下是您需要遵循的不同步骤，以便在模块中注册新的内部变量/函数。

**1st step:** 在模块内创建一个名为`generate_<internal_variable_or_function_name>()` 的方法，它将生成您的内部变量/函数，这意味着它将返回一个 lambda 函数（代表内部函数）或直接返回您想要公开的内部变量。

所有生成方法都根据内部变量/函数名称按字母顺序排列。

尝试为您的变量/函数提供一个很好的、不言自明的名称。

**2nd step:** 根据执行时文件上的内部变量/函数是否在 `static_templates` 或 `dynamic_templates` 映射中注册您的内部变量/函数。注册发生在 `createStaticTemplates` 或 `updateTemplates` 中。

要注册您的变量/函数，请使用预定义的 `this.generate_<internal_variable_or_function_name>()` 方法：

`*this*.static_templates.*set*(<internal_variable_or_function_name>, *this*.generate_<internal_variable_or_function_name>());`

```js
*this*.dynamic_templates.*set*(<internal_variable_or_function_name>, *this*.generate_<internal_variable_or_function_name>());
```

内部变量/函数注册也根据变量/函数名称按字母顺序排列。

**3rd step:**将您的内部变量/函数文档添加到 [[Templater]] 的[说明文档](https://github.com/SilentVoid13/Templater/tree/master/docs/docs/internal-variables-functions/internal-modules).

大功告成！感谢您的贡献 [Templater](https://github.com/SilentVoid13/Templater) !

现在，只需在 Github 上提交一个 [pull request](https://github.com/SilentVoid13/Templater/pulls)，我会尽快回应。

上一节：[Web 模块](Web%20模块.md)下一节：[概述](../用户函数/概述.md)

