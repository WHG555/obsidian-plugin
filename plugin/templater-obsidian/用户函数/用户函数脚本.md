# 用户函数脚本

此类用户函数允许您从 JavaScript 文件调用 JavaScript 函数并检索其输出。

要使用脚本用户功能，您需要在 [[Templater]] 的设置中指定一个脚本文件夹。此文件夹需要可从您的保管库访问。

## 定义脚本用户函数

假设您在 [[Templater]] 的设置中将 `Scripts` 文件夹指定为脚本文件夹。

例如，您可以创建名为 “Scripts/my_script.js” 的脚本（需要 “.js” 扩展名）。

脚本应遵循 [CommonJS 模块规范](https://flaviocopes.com/commonjs/)，并导出单个函数。

让我们用之前的脚本 `my_script.js` 举一个例子：

```js
*function* my_function (msg) {

​    console.log("Message from my script:", msg);

}

module.exports = my_function;
```

[[Templater]] 然后将加载 `Scripts` 文件夹中的所有 JavaScript（`.js` 文件）脚本。

然后，您将能够将脚本作为用户函数调用。函数名对应脚本文件名。

在我们之前的示例中，完整的命令调用如下所示：

```js
<% tp.user.my_script("Hello World!") %>
```

会在控制台打印 `Message from my script: Hello World!` 。

##### INFO

> 在脚本用户函数中，您仍然可以访问全局命名空间变量，例如 `app` 或 `moment`。
> 但是，您无法访问 Eta 范围的变量，例如 `tp` 或 `tR`。如果要使用它们，则必须将它们作为函数的参数传递。

## 函数参数

您可以将任意数量的参数传递给您的函数，具体取决于您定义它的方式。

例如，您可以将 `tp` 对象传递给您的函数，以便能够使用所有 [内部变量/函数](https://silentvoid13.github.io/Templater/docs/internal-variables-functions) Template：

`<% tp.user.<user_function_name>(tp) %>`

上一节： [概述](概述.md)下一节：[系统命令用户功能](系统命令用户功能.md)